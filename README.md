# Sampling-based Algorithms for Motion Planning

## Overview

This project, conducted from **June 1 to July 31, 2023**, focused on **sampling-based algorithms for motion planning in robotics**. Our team, composed of 4 members and supervised by **Dr. Israel Becerra Dur√°n**, researched and implemented the following algorithms:

- **PRM***  
- **RRT**  
- **RRG**  
- **RRT***  

Our work was based on the paper _Sampling-based algorithms for optimal motion planning_ (2011) by Sertac Karaman and Emilio Frazzoli, as well as the book _Planning Algorithms_ (2006) by Steven M. LaValle. This document describes the implementation and simulation of these algorithms and how neural networks were used to predict trajectories based on the simulations.

---

## Problem Statement

The goal of this project was to evaluate the performance of the algorithms in a controlled environment, keeping conditions the same for each one. The simulations, performed in **Python**, used a **2D maze** with 16 cells (4x4). The robot was represented as a circular object with a radius of 0.25.

---

## Algorithm Implementation

Each team member implemented one of the algorithms described in _Sampling-based algorithms for optimal motion planning_. Initially, we considered fixed starting points and a fixed number of iterations to generate trajectories.

### Observations

- **RRT and RRT*** clearly show a tree-like structure, with edges connecting nodes without forming cycles.  
- **PRM* and RRG**, being graph-based, present a higher edge density and the presence of cycles.  
- **RRT*** generates more optimal trajectories than **RRT** due to its _rewiring_ process, which results in straighter paths. However, these trajectories tend to get too close to the maze walls.  
- Graph-based algorithms can reach more locations in the maze in different ways, although they may not always produce the most direct paths compared to tree-based algorithms.

---

## Neural Network Training

We used a neural network for each algorithm to predict trajectories from the data generated by the planning algorithms. We generated **2,400 trajectories** to train the networks, considering random start and goal points within each of the 16 cells.

### Neural Network Structure

Given an initial point _p_ and a target point _q_, the neural network receives the tuple \([p_t, q]\) as input and returns the next point _p_{t+1}_, which should ideally be closer to _q_.

We used **TensorFlow** and **Sklearn** to build and train the neural networks:

- **TensorFlow:** Used with a 25% dropout to prevent overfitting, with a maximum of 4,000 iterations.  
- **Sklearn:** A basic neural network without dropout, also with a maximum of 4,000 iterations.

---

## Results

### Trajectory Prediction with Sklearn

| Algorithm | % Successful Trajectories | Avg. Time | Avg. Cost (Length) | Std. Dev. Time | Std. Dev. Cost |
|-----------|----------------------------|-----------|-------------------|----------------|----------------|
| PRM*      | 30%                        | 0.00137   | 3.72              | 0.00133        | 3.05           |
| RRT       | 82%                        | 0.00153   | 201.93           | 0.00099        | 152.54         |
| RRG       | 32%                        | 0.00196   | 3.44              | 0.00127        | 2.28           |
| RRT*      | 42%                        | 0.00391   | 4.12              | 0.00244        | 2.54           |

---

### Trajectory Prediction with TensorFlow

| Algorithm | % Successful Trajectories | Avg. Time | Avg. Cost (Length) | Std. Dev. Time | Std. Dev. Cost |
|-----------|----------------------------|-----------|-------------------|----------------|----------------|
| PRM*      | 36%                        | 0.4661    | 4.35              | 0.614          | 3.12           |
| RRT       | 99%                        | 0.9934    | 202.98           | 0.522          | 178.91         |
| RRG       | 23%                        | 0.4440    | 2.64              | 0.340          | 2.06           |
| RRT*      | 59%                        | 0.2875    | 4.80              | 0.167          | 2.79           |

---

### Trajectory Prediction with TensorFlow (Dropout)

| Algorithm | % Successful Trajectories | Avg. Time | Avg. Cost (Length) | Std. Dev. Time | Std. Dev. Cost |
|-----------|----------------------------|-----------|-------------------|----------------|----------------|
| PRM*      | 30%                        | 0.6948    | 3.40              | 0.875          | 2.45           |
| RRT       | 86%                        | 2.059     | 348.37           | 2.25           | 427.91         |
| RRG       | 24%                        | 0.4374    | 2.78              | 0.353          | 2.24           |
| RRT*      | 37%                        | 0.2323    | 3.47              | 0.138          | 2.15           |

---

## Conclusions

- **RRT** achieved the highest percentage of successful trajectories across all neural networks. This is because its trajectories do not cling to the maze walls, reducing the risk of collisions.  
- **RRT*** generates more optimal trajectories in less time and at a lower cost. However, its tendency to get too close to walls results in more collisions.  
- **RRG** behaved similarly to RRT*, with optimal trajectories but fewer successes due to the same issue.  
- **PRM*** had a low percentage of successful trajectories because its training dataset contained fewer intermediate points, which affected the network's performance.

---

## References

- Karaman, Sertac, and Emilio Frazzoli. _Sampling-based algorithms for optimal motion planning_, 2011.  
- LaValle, Steven M. _Planning Algorithms_, 2006.  

